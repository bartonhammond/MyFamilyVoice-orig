<span ng-init="init()"></span>
<div>
<input style="width: 35%" type="text"
       ng-model="search.q"></input>
<i ng-click="performSearch()"
   class="fa fa-search fa-2"></i> 
</div>

<div class="table-responsive">
  <table class="table table-striped table-hover table-condensed">
      <tr ng-repeat="item in search.items">
        <td class="col-md-1">
          <img ng-click="listened($index)" ng-src="{{item.thumbnail._url}}"></img>
        </td>
        <td class="col-md-11">
          <div ng-if="item.type === 'user'">
            <a ng-href="#/activities/list/{{item.objectId}}">
               {{item.description}}
            </a>
            <br>
            Active since: {{item.active}}
            <br>
            Has listened to: {{item.viewed}}
            <br>
            Has been heard: {{item.audioViews}}
            <br>
            <div class="btn-group btn-group-sm">
              <button ng-click="joinFamily($index)"
                      type="button" 
                      ng-disabled="item.isSelf || item.isInFamily"
                      class="btn btn-default">
                <span ng-if="item.isInFamily">In Family</span>
                <span ng-if="!item.isInFamily">Join Family</span>
              </button>
            </div>
            <div ng-show="item.familyRequestSent" 
                 class="alert alert-success alert-dismissable">
              <button type="button" 
                      class="close" 
                      data-dismiss="alert" 
                      aria-hidden="true">
                &times;
              </button>
              Your family request has been sent.  Once approved you
              will be able to submit questions.
            </div>
            <div class="btn-group btn-group-sm">
              <button ng-click="subscribe($index)"
                      ng-disabled="item.isSelf"
                      type="button" 
                      class="btn btn-default">
                <span ng-if="item.isSubscribed">Unsubscribe</span>
                <span ng-if="!item.isSubscribed">Subscribe</span>
              </button>
            </div>
            <div ng-show="item.subscribed" 
                 class="alert alert-success alert-dismissable">
              <button type="button" 
                      class="close" 
                      data-dismiss="alert" 
                      aria-hidden="true">
                &times;
              </button>
              You are now subscribed to {{item.description}}.
            </div>
          </div>
          <div ng-if="item.type === 'activity'">
            <a ng-href="#/activities/edit/{{item.objectId}}">
               {{item.description}}
            </a>
            <br>
            <a ng-click="listened($index)" ng-href={{item.audio._url}}
               target=_blank>Audio</a>
            <br>
            By: <a ng-href="#/activities/list/{{item.userId}}"
                   >{{item.userName}}</a>
            <br>
            {{item.active}}
            <br>
            {{item.views}} listened
          </div>
        </td>
      </tr>
  </table>
</div>
